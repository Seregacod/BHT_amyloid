# BHT_amyloid
Данный проект посвящен анализу влияния аминокислотных замен на структурную стабильность белков в контексте амилоидогенности и выполнен в рамках Хакатона по Биоинформатике (2025).
## Авторы: Владимир Свистак, Андрей Крюков, Егор Пивоваров, Дарья Янчик, Сергей Иванов, Ксения Суханова
## Описание, цель и задачи проекта
На данный момент наша работа связана с анализом классических и некоторых рибосомальных амилоидогенных белков, а именно **цель** нашей работы - **это провести интегративный вычислительный анализ для прогнозирования эффектов аминокислотных замен на амилоидогенность и структурную стабильность белков и модулирования региональной склонности этих белков к агрегации.**

Отсюда **задачи** нашего проекта выглядят следующим образом:

**1. Картировать амилоидогенные регионы с разрешением до одного остатка**

**2. Предскзаать точечные мутации, подавляющие амилоидные свойства исследуемых белков**

**3. Прояснить биофизические механизмы, обуславливающие изменения амилоидогенного потенциала**


### В данном репозитории представлены скрипты и файлы, написанные нами в ходе работы. Содержание репозитория и основные функции каждого из элементов перечислены ниже:
### 1. Папка "аа"
На данный момент папка содержит наброски по пайплайну для работы с молекулярной динамикой и альфафолдом, что будет необходимо для введения мутаций в структуру белка и проверку её влияния. Сейчас здесь находится скрипт для парсинга описания структур из SMILES нотации
### 2. Папка "all"
Папка содержит csv таблицы, в которых собраны результаты предсказания от различных предикторов амилоидогенности для исследуемых белков дикого типа, некоторых мутантных вариантов (mut), скрипты для визуализации распределения соответствующих скоров и графики (graphics), а также тепловые карты бинарного распределения попадания аминокислоты в амилоидогенный регион по версии каждого из предикторов (hm)
### 3. Папка "api"
Папка содержит python-скрипты, обеспечивающие непосредственный доступ к некоторым из предикторов, представленных в качестве веб-сервисов, в СLI формате (command-line interface)
### 4. Папка "metascores"
Содержит csv таблицы метаскоров для каждой аминокислоты в составе белка и мутантных вариантов. Все таблицы имеют унифицированный вид в виде следующего списка столбцов:

aa - номер аминокислоты в белке начиная с N конца последовательности.

aa_name - название аминокислотного остатка в однобуквенной кодировке.

metascore_WT - метаскор, расчитанный по взвешенной формуле.

metascore_A**B - метаскоры для АА в составе мутантных белков. Мутации записаны в стандартном виде (например P55A - замена пролина на лизин в 55 положении).

**region(s)_for_analysis** (сейчас нет, но стоит добавить) - бинарная кодировка вхождения аминокислоты в консенсусный амилоидогенный регион

Пример таблицы представлен на картинке ниже:

![photo_2026-01-06_18-03-46](https://github.com/user-attachments/assets/33bc5154-019c-4b4a-9656-78e34e412fd6)

### 5. AGGRESSOR.py

Программа для внесения мутаций в последовательность белка. Принимает на вход fasta файл с WT типом белка, а также требует разметку консенсусных регионов в качестве ключевого параметра. Далее по определённым правилам выявляет в составе этого региона аминокислоты, несущие наибольший амилоидогенный потенциал (хот-спот АК или бета-промотеры), после чего происходит мутация данный АК на бета-брейкерные мутации (то есть существенно понижающие амилоидогенный потенциал; это тоже происходит по определённым правилам). 

В результате на выходе получается multifasta файл со всеми мутированными последовательностями + WT (по умолчанию также включается в файл), ранжированными по внутренней метрике (aggregation_score), определяемая взвешенным образом согласно тому, насколько "точно" конкретный регион соответствовал группе правил для определения амилодогенности.

### 6. PASTA_visual.py

Скрипт для визуализации данных из PASTA (?)

### 7. appnn_converter.R

R скрипт, посвященный получению результатов из APPNN - нейронной сети для предсказания амилодогенности, представленной в виде одноименного R пакета. Скрипт принимает на вход multifasta файл с последовательностями белков, прогоняет их через APPNN, и затем парсит результат. На выходе получается csv таблица с названием белка, средним значением скора, скорам по каждой аминокислоте (в таблице также представлены названия аминокислот) и хот-спот регионами, вносящими наибольший вклад в амилоидогенность. 

**NB! В ходе парсинга скрипт создает временный temp.csv файл, что стоит учитывать при использовании**

### 8. arch_cross_pasta_aggreplot_waltz_parser.ipynb

Универсальный парсер для нескольких перечисленных в названии предикторов в формате jupyter notebook

### 9. path_converter.py

Парсер для предиктора PATH, работающего по механизму трединга (threading), устанавливающегося локально

### 10. wilcoxon.py

Скрипт для визуализации распределения метаскоров и дельта-метаскоров для белков и их мутантных вариантов.

Скрипт сначала анализирует распределение по всей длине последовательности (и строит соответствующие визуализации), затем анализирует конкретные регионы, показавшие наибольшее отличие по дельтаскору. Статистический анализ проводится по Вилкоксону и только для небольших регионов на основе дельтаскоров, поскольку данные в целом оказываются довольно разрешенными и представляют из себя по сути "zero-inflated" таблицы.

На вход скрипт принимает csv файл в том формате, в каком они представлены в папке metascores, после чего проводит визуализацию и статистический анализ, на выходе создает директорию со всеми файлами. 

**Детальный перечень файлов в директории, возможные субдиректории и пр. описано в REAMDE.txt файле, который также создается на выходе.*

**NB! Для анализа скрипту желательно (но необязятельно) передать на входе начало-конец консенсусных регионов для анализа. Если никакие регионы не указаны, то программа попытается их рассчитать по распределению дельтаскоров (иногда это может быть полезно, если мутация проявляет какой-либо "дальний" эффект). Параметры для расчета этих регионов можно варьировать в самом скрипте, они прописаны в её справке, которую можно вызвать в терминале***
